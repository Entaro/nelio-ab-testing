NelioABFreeTrial={$basicInfoAction:jQuery("#nelio-ft-basic-info"),$siteInfoAction:jQuery("#nelio-ft-site-info"),$goalsAction:jQuery("#nelio-ft-goals"),$tweetAction:jQuery("#nelio-ft-tweet"),$connectAction:jQuery("#nelio-ft-connect"),$recommendAction:jQuery("#nelio-ft-recommend"),mailValidator:/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i,init:function(){jQuery(".free-trial-action select, .free-trial-action input").prop("disabled",true);jQuery(".cta a.button").click(function(){var a=jQuery(this).parent().data("action");if(jQuery.inArray(a,["tweet","connect"])>=0){return}NelioABFreeTrial.performAction(a)});this.configureBasicInfoAction()},markAsDisabled:function(a){a.removeClass("action-completed");a.addClass("action-disabled");a.addClass("no-shadow");a.find(".cta a.button").addClass("disabled")},markAsAvailableIfPossible:function(a){if(a.hasClass("action-completed")){return}a.removeClass("action-disabled");a.removeClass("no-shadow");a.find("select,input").prop("disabled",false)},markAsCompleted:function(a){a.removeClass("action-disabled");a.addClass("action-completed");a.addClass("no-shadow");a.find(".cta a.button").addClass("disabled");a.find("select,input").prop("disabled",true)},configureOtherCards:function(){jQuery(".free-trial-action").find("input,select").each(function(){jQuery(this).prop("disabled",false)});this.configureSiteInfoAction();this.configureGoalsAction();this.configureTweetAction();this.configureConnectAction();this.configureRecommendAction();jQuery(".free-trial-action.action-disabled,.free-trial-action.action-completed").find("input,select").each(function(){jQuery(this).prop("disabled",true)})},configureBasicInfoAction:function(){var f=this.$basicInfoAction;var d=f.find(".cta a.button");if(f.hasClass("action-disabled")){this.markAsAvailableIfPossible(f)}else{if(f.hasClass("pending-confirmation")){this.markAsAvailableIfPossible(f);d.addClass("disabled");jQuery.ajax({url:ajaxurl,async:true,method:"POST",data:{action:"nelioab_free_trial_promo",promo:"basic-info-check"},success:function(g){d.removeClass("disabled");if("OK"===g){f.removeClass("pending-confirmation");NelioABFreeTrial.markAsCompleted(f);NelioABFreeTrial.configureOtherCards()}},error:function(){d.removeClass("disabled");NelioABFreeTrial.configureOtherCards()}})}else{this.configureOtherCards()}}var e=jQuery("#your-name");var c=function(){var g=e.attr("value");if(typeof g==="undefined"){return false}if(g.length===0){return false}return true};e.on("change keyup",function(){if(!c()){jQuery(this).addClass("error");d.addClass("disabled")}else{jQuery(this).removeClass("error");if(a()){d.removeClass("disabled")}else{d.addClass("disabled")}}});var b=jQuery("#your-email");var a=function(){var g=b.attr("value");if(typeof g==="undefined"){return false}if(g.length===0){return false}return NelioABFreeTrial.mailValidator.test(g)};b.on("change keyup",function(){if(!a()){jQuery(this).addClass("error");d.addClass("disabled")}else{jQuery(this).removeClass("error");if(c()){d.removeClass("disabled")}else{d.addClass("disabled")}}})},configureSiteInfoAction:function(){var f=this.$siteInfoAction;NelioABFreeTrial.markAsAvailableIfPossible(f);if(f.hasClass("action-completed")){return}var d=f.find(".cta a.button");var c=jQuery("#business-type-selector");var e=function(){return c.attr("value")!="unknown"};c.on("change",function(){if(!e()){jQuery(this).addClass("error");d.addClass("disabled")}else{jQuery(this).removeClass("error");if(a()){d.removeClass("disabled")}else{d.addClass("disabled")}}});var b=jQuery("#business-sector-selector");var a=function(){return b.attr("value")!="unknown"};b.on("change",function(){if(!a()){jQuery(this).addClass("error");d.addClass("disabled")}else{jQuery(this).removeClass("error");if(e()){d.removeClass("disabled")}else{d.addClass("disabled")}}})},configureGoalsAction:function(){var f=this.$goalsAction;NelioABFreeTrial.markAsAvailableIfPossible(f);if(f.hasClass("action-completed")){return}var d=f.find(".cta a.button");var b=jQuery("#the-goal");var c=function(){var g=b.attr("value");if(typeof g==="undefined"){return false}if(g.length<5){return false}return true};b.on("change keyup",function(){if(!c()){jQuery(this).addClass("error");d.addClass("disabled")}else{jQuery(this).removeClass("error");if(a()){d.removeClass("disabled")}else{d.addClass("disabled")}}});var e=jQuery("#success");var a=function(){var g=e.attr("value");if(typeof g==="undefined"){return false}if(g.length<5){return false}return true};e.on("change keyup",function(){if(!a()){jQuery(this).addClass("error");d.addClass("disabled")}else{jQuery(this).removeClass("error");if(c()){d.removeClass("disabled")}else{d.addClass("disabled")}}})},configureTweetAction:function(){var a=this.$tweetAction;NelioABFreeTrial.markAsAvailableIfPossible(a);if(a.hasClass("action-completed")){return}twttr.ready(function(){twttr.events.bind("tweet",function(b){NelioABFreeTrial.tweet()})})},configureConnectAction:function(){jQuery(document).ready(function(){var c=NelioABFreeTrial.$connectAction;NelioABFreeTrial.markAsAvailableIfPossible(c);if(c.hasClass("action-completed")){return}var b=jQuery("#dialog-modal");var a=c.find(".cta a");a.removeClass("disabled");b.dialog({title:"Facebook",dialogClass:"wp-dialog",modal:true,autoOpen:false,width:460,height:200,closeOnEscape:true});a.click(function(){b.dialog("open");return false})})},configureRecommendAction:function(){var d=this.$recommendAction;NelioABFreeTrial.markAsAvailableIfPossible(d);if(d.hasClass("action-completed")){return}var a=d.find(".cta a.button");var b=jQuery("#list-of-emails");var c=function(){var f=b.attr("value");if(typeof f==="undefined"){return false}var g;f=f.replace(/\s/g,"");f=f.replace(/,,+/g,",");if(f.indexOf(",")===-1){g=[f]}else{g=f.split(",")}for(var e=0;e<g.length;++e){if(!NelioABFreeTrial.mailValidator.test(g[e])){return false}}return true};b.on("change keyup",function(){if(!c()){jQuery(this).addClass("error");a.addClass("disabled")}else{jQuery(this).removeClass("error");a.removeClass("disabled")}})},performAction:function(b){var a=jQuery("#nelio-ft-"+b+" .cta a.button");if(a.hasClass("disabled")){return}else{if("basic-info"===b){this.submitBasicInformation()}else{if("goals"===b){this.submitGoals()}else{if("site-info"===b){this.submitSiteInformation()}else{if("tweet"===b){}else{if("connect"===b){this.connect()}else{if("recommend"===b){this.submitFriendList()}}}}}}}},submitBasicInformation:function(){var b=this.$basicInfoAction;var a=b.find(".cta a.button");a.addClass("disabled");jQuery.ajax({url:ajaxurl,async:true,method:"POST",data:{action:"nelioab_free_trial_promo",promo:"basic-info",name:jQuery("#your-name").attr("value"),email:jQuery("#your-email").attr("value")},success:function(d){a.removeClass("disabled");if("OK"===d){a.addClass("disabled");if(b.hasClass("pending-confirmation")){var c=b.find(".nelio-freetrial-heading img");var e=b.find(".nelio-freetrial-heading.completed img");e.attr("src",c.attr("src"))}NelioABFreeTrial.markAsCompleted(b);b.addClass("pending-confirmation")}},error:function(){a.removeClass("disabled")}})},submitGoals:function(){var b=this.$goalsAction;var a=b.find(".cta a.button");a.addClass("disabled");jQuery.ajax({url:ajaxurl,async:true,method:"POST",data:{action:"nelioab_free_trial_promo",promo:"goals",goal:jQuery("#the-goal").attr("value"),success:jQuery("#success").attr("value")},success:function(c){a.removeClass("disabled");if("OK"===c){NelioABFreeTrial.markAsCompleted(b)}},error:function(){a.removeClass("disabled");NelioABFreeTrial.markAsAvailableIfPossible(b)}})},submitSiteInformation:function(){var b=this.$siteInfoAction;var a=b.find(".cta a.button");a.addClass("disabled");jQuery.ajax({url:ajaxurl,async:true,method:"POST",data:{action:"nelioab_free_trial_promo",promo:"site-info",type:jQuery("#business-type-selector").attr("value"),sector:jQuery("#business-sector-selector").attr("value")},success:function(c){a.removeClass("disabled");if("OK"===c){NelioABFreeTrial.markAsCompleted(b)}},error:function(){a.removeClass("disabled");NelioABFreeTrial.markAsAvailableIfPossible(b)}})},tweet:function(){var b=this.$tweetAction;var a=b.find(".cta a.button");a.addClass("disabled");jQuery.ajax({url:ajaxurl,async:true,method:"POST",data:{action:"nelioab_free_trial_promo",promo:"tweet",},success:function(c){a.removeClass("disabled");if("OK"===c){NelioABFreeTrial.markAsCompleted(b)}},error:function(){a.removeClass("disabled");NelioABFreeTrial.markAsAvailableIfPossible(b)}})},connect:function(){var b=this.$tweetAction;var a=b.find(".cta a.button");a.addClass("disabled");jQuery("#dialog-modal").dialog("close");jQuery.ajax({url:ajaxurl,async:true,method:"POST",data:{action:"nelioab_free_trial_promo",promo:"connect",},success:function(c){a.removeClass("disabled");if("OK"===c){NelioABFreeTrial.markAsCompleted(b)}},error:function(){a.removeClass("disabled");NelioABFreeTrial.markAsAvailableIfPossible(b)}})},submitFriendList:function(){var d=this.$recommendAction;var a=d.find(".cta a.button");a.addClass("disabled");var c;var b=jQuery("#list-of-emails").attr("value");b=b.replace(/\s/g,"");b=b.replace(/,,+/g,",");if(b.indexOf(",")===-1){c=[b]}else{c=b.split(",")}c=c.join(",");jQuery.ajax({url:ajaxurl,async:true,method:"POST",data:{action:"nelioab_free_trial_promo",promo:"recommend",value:c},success:function(e){a.removeClass("disabled");if("OK"===e){NelioABFreeTrial.markAsCompleted(d)}},error:function(){a.removeClass("disabled");NelioABFreeTrial.markAsAvailableIfPossible(d)}})}};NelioABFreeTrial.init();